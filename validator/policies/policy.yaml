policies:

  # =====================================================================
  #  SBOM TOP-LEVEL REQUIREMENTS
  # =====================================================================
  require_bom_format:
    id: BOM_FORMAT_REQUIRED
    display_name: "BOM Format Required"
    category: bom
    description: "SBOM must define bomFormat (CycloneDX or SPDX)."
    reason: "Required by NTIA minimum elements."
    severity: error
    strict: true

  require_spec_version:
    id: SPEC_VERSION_REQUIRED
    display_name: "Spec Version Required"
    category: bom
    description: "SBOM must define specVersion."
    reason: "Spec version determines schema and validation logic."
    severity: error
    strict: true

  require_metadata_section:
    id: METADATA_SECTION_REQUIRED
    display_name: "Metadata Section Required"
    category: metadata
    description: "Metadata section must exist in SBOM."
    reason: "Metadata is required by NTIA minimum elements."
    severity: error
    strict: true

  # =====================================================================
  #  METADATA → ROOT COMPONENT
  # =====================================================================
  require_root_component:
    id: ROOT_COMPONENT_REQUIRED
    display_name: "Root Component Required"
    category: metadata
    description: "SBOM metadata must contain a root component."
    reason: "Root component identifies the software described by the SBOM."
    severity: error
    strict: true

  require_root_component_name:
    id: ROOT_COMPONENT_NAME_REQUIRED
    display_name: "Root Component Name Required"
    category: metadata
    description: "Root component must contain a valid name."
    reason: "Name uniquely identifies the main software artifact."
    severity: error
    strict: true

  require_root_component_ref:
    id: ROOT_COMPONENT_REF_REQUIRED
    display_name: "Root Component bom-ref Required"
    category: metadata
    description: "Root component must contain a stable bom-ref."
    reason: "bom-ref maps dependencies to components."
    severity: error
    strict: true

  # =====================================================================
  #  METADATA → SUPPLIER
  # =====================================================================
  require_metadata_supplier:
    id: METADATA_SUPPLIER_REQUIRED
    display_name: "Metadata Supplier Required"
    category: metadata
    description: "Metadata.supplier must be defined."
    reason: "Supplier attribution required by NTIA."
    severity: error
    strict: true

  require_metadata_supplier_name:
    id: METADATA_SUPPLIER_NAME_REQUIRED
    display_name: "Metadata Supplier Name Required"
    category: metadata
    description: "Metadata.supplier must contain supplier.name."
    reason: "Ensures traceability and ownership."
    severity: error
    strict: true

  # =====================================================================
  #  COMPONENT REQUIREMENTS
  # =====================================================================
  require_component_name:
    id: COMPONENT_NAME_MISSING
    display_name: "Component Name Required"
    category: components
    description: "Every component must have a name."
    reason: "Component identity is required."
    severity: error
    strict: true

  require_component_version:
    id: COMPONENT_VERSION_MISSING
    display_name: "Component Version Required"
    category: components
    description: "Component version must be defined when applicable."
    reason: "Versioning required for reproducibility and vulnerability mapping."
    severity: error
    strict: true

  require_description:
    id: COMPONENT_DESCRIPTION_MISSING
    display_name: "Component Description Missing"
    category: components
    description: "Component description is optional but recommended."
    reason: "Descriptions improve readability and understanding."
    severity: off
    strict: false

  require_supplier:
    id: COMPONENT_SUPPLIER_MISSING
    display_name: "Component Supplier Missing"
    category: components
    description: "Each component should provide supplier information."
    reason: "Attribution helps in trust and supply-chain responsibilities."
    severity: warning
    strict: false

  require_purl:
    id: PURL_MISSING
    display_name: "PURL Missing"
    category: identity
    description: "Component missing Package URL (PURL)."
    reason: "PURL is required for package identity and vulnerability match."
    severity: error
    strict: true

  validate_version_semver:
    id: COMPONENT_VERSION_INVALID
    display_name: "Invalid SemVer Version"
    category: components
    description: "Component version is not valid semantic versioning."
    reason: "Invalid versions break SBOM consumers and scanners."
    severity: warning
    strict: false

  validate_spdx_license_id:
    id: LICENSE_UNKNOWN
    display_name: "Invalid SPDX License Identifier"
    category: license
    description: "Invalid SPDX license tokens detected."
    reason: "License fields must follow SPDX rules."
    severity: warning
    strict: false

  require_license:
    id: LICENSE_MISSING
    display_name: "License Missing"
    category: license
    description: "Component must declare a license or license object."
    reason: "License information is required by NTIA."
    severity: warning
    strict: false

  require_cpe_or_purl:
    id: IDENTIFIER_MISSING
    display_name: "Identifier Missing"
    category: identity
    description: "Component must have at least one valid identifier (PURL or CPE)."
    reason: "Components must be uniquely identifiable."
    severity: warning
    strict: false

  # =====================================================================
  #  AUTHOR & TIMESTAMP
  # =====================================================================
  require_author:
    id: AUTHOR_REQUIRED
    display_name: "Author Missing"
    category: metadata
    description: "Authors must be provided in the metadata."
    reason: "Creator information is required for traceability."
    severity: off
    strict: false

  require_timestamp:
    id: TIMESTAMP_MISSING
    display_name: "Timestamp Required"
    category: metadata
    description: "SBOM must contain a metadata timestamp."
    reason: "Timestamps help identify SBOM freshness."
    severity: off
    strict: false

  # =====================================================================
  #  DEPENDENCY GRAPH VALIDATION
  # =====================================================================
  require_dependencies:
    id: DEPENDS_ON_MISSING
    display_name: "Dependencies Missing"
    category: dependencies
    description: "Dependency graph missing or empty."
    reason: "Dependencies enable traceability and vulnerability impact analysis."
    severity: error
    strict: true

  # =====================================================================
  #  HYGIENE
  # =====================================================================
  component_duplicate:
    id: COMPONENT_DUPLICATE
    display_name: "Duplicate Component Detected"
    category: hygiene
    description: "Duplicate components detected."
    reason: "Duplicates can cause dependency resolution issues."
    severity: error
    strict: true

  empty_field:
    id: EMPTY_FIELD
    display_name: "Empty Field"
    category: hygiene
    description: "One or more fields contain empty or null values."
    reason: "Empty values weaken SBOM quality."
    severity: warning
    strict: false
