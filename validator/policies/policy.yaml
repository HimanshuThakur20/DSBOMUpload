policies:

  # ======================
  # CORE FIELDS
  # ======================
  require_timestamp:
    id: REQUIRED_METADATA
    display_name: "Metadata Timestamp Required"
    category: metadata
    description: "SBOM must include metadata timestamp field"
    reason: "Timestamp ensures traceability and provenance."
    severity: error
    strict: true

  require_author:
    id: REQUIRED_METADATA_COMPONENT
    display_name: "Author / Creator Required"
    category: metadata
    description: "SBOM must define author or creator"
    reason: "Author allows accountability and SBOM ownership."
    severity: error
    strict: true

  # ======================
  # VERSION CHECKS
  # ======================
  require_component_version:
    id: COMPONENT_VERSION_MISSING
    display_name: "Component Version Required"
    category: components
    description: "Component missing 'version' field"
    severity: error
    strict: true

  validate_version_semver:
    id: COMPONENT_VERSION_INVALID
    display_name: "Invalid Semantic Version"
    category: components
    description: "Version does not follow semver format"
    severity: warning
    strict: false

  # Future: version ranges  
  # component_version_range:
  #   id: COMPONENT_VERSION_RANGE
  #   display_name: "Loose Version Range"
  #   category: components
  #   severity: warning

  # ======================
  # LICENSE CHECKS
  # ======================
  require_license:
    id: LICENSE_MISSING
    display_name: "License Missing"
    category: license
    description: "Component does not define a license"
    severity: warning
    strict: false

  validate_spdx_license_id:
    id: LICENSE_UNKNOWN
    display_name: "Invalid SPDX License"
    category: license
    description: "Component contains invalid SPDX license identifier"
    severity: warning
    strict: false

  # ======================
  # PURL
  # ======================
  require_purl:
    id: PURL_MISSING
    display_name: "PURL Missing"
    category: identity
    description: "Component missing Package URL (purl)"
    severity: error
    strict: true

  # ======================
  # SUPPLIER
  # ======================
  require_supplier:
    id: SUPPLIER_MISSING
    display_name: "Supplier Missing"
    category: metadata
    description: "Supplier is missing for component"
    severity: warning
    strict: false

  # ======================
  # DEPENDENCIES
  # ======================
  require_dependencies:
    id: DEPENDS_ON_MISSING
    display_name: "Dependencies Missing"
    category: dependencies
    description: "Dependencies section missing or incomplete"
    severity: error
    strict: true

  # ======================
  # DUPLICATES
  # ======================
  component_duplicate:
    id: COMPONENT_DUPLICATE
    display_name: "Duplicate Component Detected"
    category: hygiene
    severity: error
    strict: true

  # ======================
  # EMPTY FIELDS
  # ======================
  empty_field:
    id: EMPTY_FIELD
    display_name: "Empty Field"
    category: hygiene
    severity: warning
    strict: false
